<section class="block tone-light" id="page-review">
  <h2 data-i18n="review.title">Review + Generate</h2>
  <p class="block-sub" data-i18n="review.sub">Choose template and colors, review match score, then generate your PDFs.</p>
  <div class="grid two">
    <label><span data-i18n="label.template">Template</span>
      <select id="review-template">
        <option value="simple" data-i18n="template.simple">Simple</option>
        <option value="friendly" data-i18n="template.friendly">Friendly</option>
      </select>
    </label>
    <label><span data-i18n="label.session_actions">Session actions</span>
      <span class="row-actions">
        <button id="clear-session-btn" type="button" class="btn-secondary" disabled data-i18n="action.clear_session">Clear session</button>
      </span>
    </label>
  </div>
  <details class="more-options" id="more-options">
    <summary data-i18n="label.more_options">More options</summary>
    <div class="grid two">
      <label><span data-i18n="label.primary_color">Primary color</span>
        <input id="review-primary" type="color" value="{{ default_primary }}">
      </label>
      <label><span data-i18n="label.accent_color">Accent color</span>
        <input id="review-accent" type="color" value="{{ default_accent }}">
      </label>
      <label><span data-i18n="label.card_bg">Card background</span>
        <input id="review-card-bg" type="color" value="#ffffff">
      </label>
      <label><span data-i18n="label.page_bg">Page background</span>
        <input id="review-page-bg" type="color" value="#ffffff">
      </label>
      <label><span data-i18n="label.font_family">Font family</span>
        <select id="review-font">
          <option value="inter" data-i18n="font.inter">Inter</option>
          <option value="roboto" data-i18n="font.roboto">Roboto</option>
          <option value="lato" data-i18n="font.lato">Lato</option>
          <option value="georgia" data-i18n="font.georgia">Georgia</option>
          <option value="source_sans" data-i18n="font.source_sans">Source Sans 3</option>
        </select>
      </label>
      <label><span data-i18n="label.border_style">Border style</span>
        <select id="review-border-style">
          <option value="rounded" data-i18n="style.rounded">Rounded corners</option>
          <option value="square" data-i18n="style.square">Square corners</option>
          <option value="none" data-i18n="style.no_borders">No borders</option>
        </select>
      </label>
      <label class="check-inline"><span data-i18n="label.box_shadow">Box shadows</span>
        <input id="review-box-shadow" type="checkbox">
      </label>
      <label><span data-i18n="label.filename_cv">CV filename</span>
        <input id="review-filename-cv" type="text" data-i18n-placeholder="placeholder.filename_cv">
      </label>
      <label><span data-i18n="label.filename_cover">Cover letter filename</span>
        <input id="review-filename-cover" type="text" data-i18n-placeholder="placeholder.filename_cover">
      </label>
    </div>
  </details>
  <div id="review-score" class="score-box" data-i18n="review.no_score">No review score yet.</div>
  <div id="review-recommendation" class="alert" style="display:none;"></div>
  <div id="review-missing" class="list-rows"></div>
  <details id="review-keyword-accordion" class="more-options" open>
    <summary data-i18n="comparison.keywords_title">Job ad vs CV keyword comparison</summary>
    <div id="review-keyword-comparison"></div>
  </details>

  <!-- Content Optimization Comparison -->
  <details id="optimization-accordion" class="more-options" open>
    <summary data-i18n="optimization.title">Content Optimization</summary>
    <p class="subtitle" data-i18n="optimization.subtitle">How your input was tailored to match this job</p>
    <div id="optimization-content"></div>
  </details>

  <!-- Quality Analysis -->
  <details id="quality-accordion" class="more-options">
    <summary data-i18n="quality.title">Quality Analysis</summary>
    <div id="quality-content"></div>
  </details>

  <!-- Strategic Analysis Section -->
  <details id="strategic-accordion" class="more-options" style="display:none;">
    <summary data-i18n="strategic.title">Application Strategy & Recommendations</summary>
    <div id="strategic-content"></div>

    <!-- Recommendations Chat -->
    <div id="strategic-chat" class="chat-bar-section" style="margin-top: 16px;">
      <h4 data-i18n="strategic.chat_title">Ask About Recommendations</h4>
      <div id="strategic-messages" class="chat-messages"></div>
      <div class="chat-input-row">
        <input id="strategic-input" type="text" data-i18n-placeholder="strategic.chat_placeholder" placeholder="e.g., How should I address the Kubernetes gap?">
        <button id="strategic-send-btn" type="button" class="btn-secondary" data-i18n="strategic.send">Ask</button>
      </div>
    </div>
  </details>

  <div class="row-actions">
    <button id="preview-match-btn" type="button" class="btn-secondary" disabled data-i18n="action.preview_match">Preview Match Score</button>
    <button id="generate-btn" type="button" class="btn-primary" disabled data-i18n="action.generate_cv">Generate CV</button>
  </div>
  <div id="cv-generated-info" style="display:none" class="alert success">
    <span data-i18n="notify.cv_generated">CV generated.</span>
    <a id="cv-download-link" href="#" target="_blank" class="btn-primary btn-link" data-i18n="action.download_cv" style="display:inline-flex;margin-top:10px;font-size:16px;padding:14px 28px;min-width:220px;text-align:center">Download CV</a>
  </div>
  <div id="chat-corrections" style="display:none" class="chat-bar-section">
    <h3 data-i18n="chat.title">Request Changes</h3>
    <div id="chat-messages" class="chat-messages"></div>
    <div class="chat-input-row">
      <input id="chat-input" type="text" data-i18n-placeholder="chat.placeholder" placeholder="e.g. Make my summary shorter...">
      <button id="chat-send-btn" type="button" class="btn-primary" data-i18n="chat.send">Send</button>
    </div>
  </div>
</section>

<section class="block tone-white" id="cover-letter-section" style="display:none">
  <h2 data-i18n="cover.title">Anschreiben / Cover Letter</h2>

  <div class="grid two">
    <label><span data-i18n="cover.sender_street">Sender street</span>
      <input id="cover-sender-street" type="text" placeholder="Bahnhofstrasse 10">
    </label>
    <label><span data-i18n="cover.sender_plz">Sender PLZ/Ort</span>
      <input id="cover-sender-plz" type="text" placeholder="5400 Baden">
    </label>
  </div>

  <div class="grid two">
    <label><span data-i18n="cover.recipient_street">Recipient street</span>
      <input id="cover-recipient-street" type="text" placeholder="Industriestrasse 5">
    </label>
    <label><span data-i18n="cover.recipient_plz">Recipient PLZ/Ort</span>
      <input id="cover-recipient-plz" type="text" placeholder="8000 Zürich">
    </label>
  </div>

  <label><span data-i18n="cover.anrede_label">Anrede</span>
    <select id="cover-anrede-known">
      <option value="no" data-i18n="cover.anrede_unknown">Zuständige Person nicht bekannt</option>
      <option value="yes" data-i18n="cover.anrede_known">Zuständige Person bekannt</option>
    </select>
  </label>
  <label id="cover-anrede-custom-wrap" style="display:none">
    <span data-i18n="cover.anrede_input">Anrede eingeben</span>
    <input id="cover-anrede-custom" type="text" placeholder="Sehr geehrte Frau Müller">
  </label>
  <label id="cover-recipient-contact-wrap" style="display:none">
    <span data-i18n="cover.contact_person">Kontaktperson (z.H.)</span>
    <input id="cover-recipient-contact" type="text" placeholder="z.H. Frau Müller">
  </label>

  <label><span data-i18n="cover.date_location">Ort für Datum</span>
    <input id="cover-date-location" type="text" placeholder="Baden">
  </label>

  <label><span data-i18n="cover.signature_label">Unterschrift (Scan/Bild, optional)</span>
    <div class="file-picker">
      <button id="signature-file-trigger" type="button" class="btn-secondary" data-i18n="cover.signature_choose">Datei wählen</button>
      <span id="signature-file-name" class="file-picker-name" data-i18n="cover.no_signature">Keine Unterschrift</span>
    </div>
    <input id="signature-file" class="visually-hidden" type="file" accept=".png,.jpg,.jpeg,.webp">
  </label>
  <div class="row-actions">
    <button id="upload-signature-btn" type="button" class="btn-secondary" disabled data-i18n="cover.upload_signature">Unterschrift hochladen</button>
  </div>

  <div class="row-actions">
    <button id="generate-cover-btn" type="button" class="btn-primary" disabled data-i18n="action.generate_cover">Generate Cover Letter</button>
  </div>
</section>

<section class="block tone-white">
  <div class="row-actions row-actions-between">
    <a class="btn-secondary btn-link" href="{{ request.url_for('page_questions') }}" data-i18n="action.back_questions">Back to Questions</a>
  </div>
</section>

<section id="result" class="result-shell"></section>
