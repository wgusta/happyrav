<!DOCTYPE html>
<html lang="{{ 'de-CH' if language == 'de' else 'en' }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CV - {{ profile.full_name }}</title>
  {% set font_css_map = {"inter": '"Inter", "Segoe UI", Arial, sans-serif', "roboto": '"Roboto", "Segoe UI", Arial, sans-serif', "lato": '"Lato", "Segoe UI", Arial, sans-serif', "georgia": 'Georgia, "Times New Roman", serif', "source_sans": '"Source Sans 3", "Segoe UI", Arial, sans-serif'} %}
  {% set font_import_map = {"inter": "https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap", "roboto": "https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap", "lato": "https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap", "source_sans": "https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600;700&display=swap"} %}
  {% set chosen_font = font_css_map.get(theme.font_family, font_css_map["inter"]) %}
  {% set chosen_import = font_import_map.get(theme.font_family, "") %}
  <style>
    {% if chosen_import %}@import url('{{ chosen_import }}');{% endif %}
    @page { size: A4; margin: 14mm 16mm; }
    :root {
      --primary: {{ theme.primary_hex }};
      --accent: {{ theme.accent_hex }};
      --ink: #1a2029;
      --muted: #586374;
      --rule: {% if theme.border_style == 'none' %}transparent{% else %}#d7dfed{% endif %};
      --panel: {{ theme.card_bg }};
      --radius: {% if theme.border_style == 'rounded' %}10px{% elif theme.border_style == 'square' %}0{% else %}0{% endif %};
      --shadow: {% if theme.box_shadow %}0 2px 8px rgba(0,0,0,0.07){% else %}none{% endif %};
      --page-bg: {{ theme.page_bg }};
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: {{ chosen_font }}; color: var(--ink); font-size: 10.4px; line-height: 1.48; background: var(--page-bg); -webkit-font-smoothing: antialiased; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    h1, h2, h3, p { margin: 0; }

    /* Card sections */
    .card { background: var(--panel); border: {% if theme.border_style != 'none' %}1px solid var(--rule){% else %}none{% endif %}; border-radius: var(--radius); padding: 16px 18px; margin-bottom: 10px; break-inside: avoid; page-break-inside: avoid; box-shadow: var(--shadow); }

    /* Header card */
    .hero { display: flex; align-items: flex-start; gap: 16px; padding: 18px 20px; margin-bottom: 12px; }
    .hero-info { flex: 1; }
    .hero h1 { font-size: 24px; color: var(--primary); line-height: 1.1; font-weight: 700; }
    .hero .headline { margin-top: 5px; font-size: 11.5px; color: var(--accent); font-weight: 700; }
    .hero .contact { margin-top: 10px; color: var(--muted); font-size: 9.6px; line-height: 1.7; }
    .hero .contact span + span::before { content: " · "; color: var(--rule); }
    .photo { width: 90px; height: 90px; border-radius: var(--radius); overflow: hidden; border: {% if theme.border_style != 'none' %}1.5px solid var(--rule){% else %}none{% endif %}; flex-shrink: 0; }
    .photo img { width: 100%; height: 100%; object-fit: cover; display: block; }

    /* Section headings */
    .card h2 { color: var(--primary); font-size: 11.2px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.4px; margin-bottom: 8px; padding-bottom: 5px; border-bottom: 1.5px solid {{ theme.primary_hex }}20; }

    /* Summary */
    .summary { font-size: 10.6px; line-height: 1.55; color: var(--ink); }

    /* Skills */
    .skill-pill {
      display: inline-block;
      margin: 3px 4px 3px 0;
      padding: 3px 9px;
      border-radius: {% if theme.border_style == 'rounded' %}999px{% else %}2px{% endif %};
      background: {{ theme.primary_hex }}0D;
      border: 1px solid {{ theme.primary_hex }}26;
      color: var(--primary);
      font-size: 9.4px;
      font-weight: 600;
    }
    .skills-list { display: flex; flex-direction: column; gap: 4px; }
    .skill-row { padding: 4px 0; border-bottom: 1px solid {{ theme.primary_hex }}10; display: flex; justify-content: space-between; align-items: baseline; }
    .skill-row:last-child { border-bottom: none; }
    .skill-name { font-weight: 600; font-size: 10px; }
    .skill-context { font-size: 8.6px; color: var(--muted); line-height: 1.3; padding-left: 10px; margin-top: 2px; }
    .skill-level-tag { font-size: 9px; color: var(--muted); }

    /* Languages */
    .lang-pills { display: flex; flex-wrap: wrap; gap: 6px; }
    .lang-pill { padding: 3px 10px; background: var(--primary); color: white; border-radius: {% if theme.border_style == 'rounded' %}5px{% else %}2px{% endif %}; font-size: 9.4px; font-weight: 600; }

    /* Experience */
    .entry { margin-bottom: 10px; break-inside: avoid; page-break-inside: avoid; }
    .entry:last-child { margin-bottom: 0; }
    .entry + .entry { padding-top: 8px; border-top: 1px solid var(--rule); }
    .entry h3 { font-size: 11px; font-weight: 700; color: var(--ink); }
    .entry-meta { color: var(--muted); font-size: 9.4px; margin-top: 2px; font-weight: 600; }
    .entry ul { margin: 5px 0 0 15px; padding: 0; }
    .entry li { margin: 3px 0; color: var(--muted); line-height: 1.42; }

    /* Education */
    .edu-entry { margin-bottom: 6px; }
    .edu-entry:last-child { margin-bottom: 0; }
    .edu-entry h3 { font-size: 10.6px; font-weight: 700; }
    .edu-meta { color: var(--muted); font-size: 9.2px; margin-top: 2px; }

    @media print { body { background: white; } }
  </style>
</head>
<body>
  <header class="card hero">
    {% if profile.photo_data_url %}
      <div class="photo"><img src="{{ profile.photo_data_url }}" alt=""></div>
    {% endif %}
    <div class="hero-info">
      <h1>{{ profile.full_name or "Candidate" }}</h1>
      {% if profile.headline %}<p class="headline">{{ profile.headline }}</p>{% endif %}
      <div class="contact">
        {% set contact_parts = [] %}
        {% if profile.location %}{% set _ = contact_parts.append(profile.location) %}{% endif %}
        {% if profile.email %}{% set _ = contact_parts.append(profile.email) %}{% endif %}
        {% if profile.phone %}{% set _ = contact_parts.append(profile.phone) %}{% endif %}
        {% for part in contact_parts %}<span>{{ part }}</span>{% endfor %}
        {% if profile.linkedin %}<br><span>{{ profile.linkedin }}</span>{% endif %}
        {% if profile.portfolio %}<span>{{ profile.portfolio }}</span>{% endif %}
      </div>
    </div>
  </header>

  {% if content.summary %}
  <section class="card">
    <h2>{{ "Kurzprofil" if language == "de" else "Profile" }}</h2>
    <p class="summary">{{ content.summary }}</p>
  </section>
  {% endif %}

  {% if profile.languages %}
  <section class="card" style="background: {{ theme.primary_hex }}06;">
    <h2>{{ "Sprachen" if language == "de" else "Languages" }}</h2>
    <div class="lang-pills">
      {% for lang in profile.languages %}
        <span class="lang-pill">{{ lang }}</span>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  {% if content.skills %}
  <section class="card">
    <h2>{{ "Kernkompetenzen" if language == "de" else "Core Competencies" }}</h2>
    <div class="skills-list">
      {% for skill in content.skills %}
        {% set colon_parts = skill.split(': ', 1) %}
        {% if colon_parts|length > 1 %}
          <div>
            <div class="skill-name">{{ colon_parts[0] }}</div>
            <div class="skill-context">{{ colon_parts[1] }}</div>
          </div>
        {% else %}
          {% set paren_parts = skill.split(' (') %}
          {% if paren_parts|length > 1 %}
            <div class="skill-row">
              <span class="skill-name">{{ paren_parts[0] }}</span>
              <span class="skill-level-tag">{{ paren_parts[1].rstrip(')') }}</span>
            </div>
          {% else %}
            <div class="skill-row">
              <span class="skill-name">{{ skill }}</span>
            </div>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <section class="card">
    <h2>{{ "Berufserfahrung" if language == "de" else "Experience" }}</h2>
    {% for item in content.experience %}
      <article class="entry">
        <h3>{{ item.role }}{% if item.company %} · {{ item.company }}{% endif %}</h3>
        {% if item.period %}<p class="entry-meta">{{ item.period }}</p>{% endif %}
        {% if item.achievements %}
          <ul>
            {% for achievement in item.achievements %}
              <li>{{ achievement }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      </article>
    {% else %}
      <p style="color: var(--muted); font-style: italic; font-size: 9.6px;">{{ "Keine Berufserfahrung angegeben" if language == "de" else "No experience provided" }}</p>
    {% endfor %}
  </section>

  {% if content.education %}
  <section class="card">
    <h2>{{ "Ausbildung" if language == "de" else "Education" }}</h2>
    {% for item in content.education %}
      <article class="edu-entry">
        <h3>{{ item.degree }}</h3>
        <p class="edu-meta">{% if item.school %}{{ item.school }}{% endif %}{% if item.period %} · {{ item.period }}{% endif %}</p>
      </article>
    {% endfor %}
  </section>
  {% endif %}
</body>
</html>
